## Basic data munging operations: structured data

|                     | Python pandas                            | PySpark RDD                              | PySpark DF                               | R dplyr                                  | Revo R dplyrXdf                          |
| ------------------- | ---------------------------------------- | ---------------------------------------- | ---------------------------------------- | ---------------------------------------- | ---------------------------------------- |
| subset columns      | `df.colname`, `df['colname']`            | `rdd.map()`                              | `df.select('col1', 'col2', ...)`         | `select(df, col1, col2, ...)`            |                                          |
| new columns         | `df['newcolumn']=...`                    | `rdd.map(function)`                      | `df.withColumn(“newcol”, content)`       | `mutate(df, col1=col2+col3, col4=col5^2,...)` |                                          |
| subset rows         | `df[1:10]`, `df.loc['rowname':]`         | `rdd.filter(function or boolean vector)`, `rdd.subtract()` |                                          | `filter`                                 |                                          |
| sample rows         |                                          | `rdd.sample()`                           |                                          |                                          |                                          |
| order rows          |                                          |                                          | `df.sort('col1')`                        | `arrange`                                |                                          |
| group & aggregate   | `df.sum(axis=0)`, `df.groupby(['A', 'B']).agg([np.mean, np.std])` | `rdd.count()`, `rdd.countByValue()`, `rdd.reduce()`, `rdd.reduceByKey()`, `rdd.aggregate()` | `df.groupBy('col1', 'col2').count().show()` | `group_by(df, var1, var2,...) %>% summarise(col=func(var3), col2=func(var4), ...)` | `rxSummary(formula, df)` or `group_by() %>% summarise()` |
| peek at data        | `df.head()`                              | `rdd.take(5)`                            | `df.show(5)`                             | `first()`, `last()`                      |                                          |
| quick statistics    | `df.describe()`                          |                                          | `df.describe()`                          | `summary()`                              | `rxGetVarInfo()`                         |
| schema or structure |                                          |                                          | `df.printSchema()`                       |                                          |                                          |